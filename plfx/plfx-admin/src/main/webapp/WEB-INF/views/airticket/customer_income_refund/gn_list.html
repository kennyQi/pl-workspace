<#assign contextPath=springMacroRequestContext.getContextPath() />

<div class="pageHeader">
	<form id="pagerForm" rel="pagerForm" onsubmit="return navTabSearch(this);" action="${contextPath}/airtkt/gnjp/supplier/income_refund/list" method="post">
		<input type="hidden" name="pageNum" value="${pagination.pageNo}" />
		<input type="hidden" name="numPerPage" value="${pagination.pageSize}" />
		<div class="searchBar">
		
			<table class="searchContent">
				<tr>
					<td>
						供应商名称：
						<select name="suppShortName">
						<option value="">请选择</option>
						<#if supplierDtoList ??>
                            <#list supplierDtoList as supplierDto>
                                <option 
                                    <#if supplierDto.number == suppShortName>
                                        selected="selected"
                                    </#if>
                                value="${(supplierDto.number)!''}">${(supplierDto.name)!''}</option>
                            </#list>
                        </#if>
						<#--<#list suppMap?keys as key>
							<option value="${key}" <#if suppShortName==key >selected="selected"</#if> >${suppMap[key]}</option>
						</#list>-->
						</select>
					</td>
					<td>
						下单人：<input type="text" name="linkerName" value="${linkerName}" />
					</td>
					<td>
						订单号：<input type="text" name="orderNo" value="${orderNo}" />
					</td>
					<td>
						下单时间：<input type="text" readonly="readonly" name="createDateFrom" value="${createDateFrom}" class="date"/>至
								 <input type="text" readonly="readonly" name="createDateTo" value="${createDateTo}" class="date"/>
					</td>
				</tr>
				<tr>
					<td>
						易行订单号：<input type="text" name="yeeXingOrderId" value="${yeeXingOrderId}" />
					</td>
					<td>
						P&nbsp;N&nbsp;R：&nbsp;<input type="text" name="pnr" value="${pnr}" />
					</td>
					<td>
						乘机人：<input type="text" name="passengerName" value="${passengerName}" />
					</td>
				</tr>
			</table>
		
			<div class="subBar">
				<ul>
					<li><div class="buttonActive">
							<div class="buttonContent"> <button type="submit">检索</button>	</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</form>
</div>

<div class="pageContent">
	
	<table class="table" width="100%" layoutH="135" id="table_caiwu">
		<thead>
			<tr>
				<th width="130">平台订单号</th>
				<th width="170">经销商订单号</th>
				<th width="90">乘机人</th>
				<th width="60">PNR</th>
				<th width="100">航程</th>
				<th width="70">支付金额</th>
				<th width="70">退款金额</th>
				<th width="150">流水号</th>
				<th width="140">下单时间</th>
				<th width="80">操作</th>
			</tr>
		</thead>
		<tbody>
		<#list pagination.list as o>
			<tr  height="60px">
				<td>
					${(o.orderNo)!""}
				</td>
				<td>
					${(o.dealerOrderCode)!""}
				</td>
				<td  colspan="5" >
						<table width="100%" height="100%" border="1">
						<tr>
			 				<th width="40">姓名</th>
			 				<th width="50">乘客类型</th>
			 				<th width="50">证件类型</th>
							<th width="80">身份证件号</th>
							<th width="80">票号</th>		
						</tr>
						<#if o.passengerList ??>
							<#list o.passengerList as passenger>
								<tr>
									<td>
									<p>${passenger.name}</p>
									</td>
									<td>
									<#if PASSENGER_TYPE_MAP??>
						                   <#list PASSENGER_TYPE_MAP?keys as itemKey>
						                       <#if itemKey == passenger.psgType>
						                       		${PASSENGER_TYPE_MAP[itemKey]}
						                       </#if>
						                   </#list>
						                </#if>
									</td>
									<td style="width:120px;">
									<#if DOCUMENT_TYPE_MAP??>
						                   <#list DOCUMENT_TYPE_MAP?keys as itemKey>
						                       <#if itemKey == passenger.idType>
						                       		${DOCUMENT_TYPE_MAP[itemKey]}
						                       </#if>
						                   </#list>
						                </#if>
									</td>
									<td>
									<p>${passenger.idNo}</p>
									</td>
									<td>
									<p>${(passenger.ticket.ticketNo)!''}</p>
									</td>
								</tr>
							</#list>
						</#if>
						</table>
					</td>
				<td>
					${(o.pnr)!""}
				</td>
				<td>
				<p>
					<#if o.startCityName??&&o.endCityName??>
						<p>${o.startCityName} — ${o.endCityName}</p>
					</#if>
					<p>${o.flightNo}</p>
					<p>${o.departureTime}</p>
				</p>
				</td>
				<td>
				<#if o.orderStatus.payStatus == '38' || o.orderStatus.payStatus == '39' || o.orderStatus.payStatus == '40'>
						${(o.userPayAmount?string('0.00'))!''}
				<#else>
						0.00
				</#if> 
				</td>
				<td>
					<#if o.orderStatus.payStatus == '43'>
					    <#if o.refundPrice??>
						${(o.refundPrice)?string('0.00')}
						</#if>
					<#else>
						0.00
					</#if>
				</td>
				<td>
					${(o.platPaySerialNumber)!""}
				</td>
				<td>
					<p>
					${o.loginName!""}
					</p>
					<#if o.createTime??>
					   ${o.createTime}
					</#if>
				</td>
				<td>
					<a href="${contextPath}/airtkt/gnjp/supplier/income_refund/detail?id=${(o.id)!''}&&refundType=${(o.refundType)!''}" style="color: blue" width="1200" height="600" target="dialog">订单详情</a>
				</td>
			</tr>
		</#list>
		</tbody>
	</table>
	<#include "/public/pagination/pagination.html">
</div>

