<#assign contextPath=springMacroRequestContext.getContextPath() />
<div class="row">
	<div class="col-md-12">
		<div class="portlet light bordered">
			<div class="portlet-title">
				<div class="caption">
					<span class="caption-subject font-red-sunglo bold uppercase">订单列表</span>
				</div>
				<div class="actions"></div>
			</div>
			<div class="portlet-body">
				<div class="row" style="letter-spacing: 4px;line-height: 17px;font-size: 14px;">
					<table style="width: 100%" border="0">
						<tr>
							<td style="width: 3%"></td>
							<td style="width: 38%">
								<table border="0" style="width: 100%">
									<tr>
										<td style="width: 20%">下单时间：</td>
										<td style="width: 40%"><input type="date" name="startDate"
											value="" class="form-control required"
											placeholder="格式：1980-01-01" maxlength="10"
											id="startDate" /></td>
										<td style="width: 40%"><input type="date" name="endDate"
											value="" class="form-control required"
											placeholder="格式：1980-01-01" maxlength="10" id="endDate" /></td>
									</tr>
								</table>
							</td>
							<td style="width: 6%"></td>
							<td style="width: 38%"><table border="0" style="width: 100%">
									<tr>
										<td style="width: 20%">航班时间：</td>
										<td style="width: 40%"><input type="date" name="inTime" value=""
											class="form-control required" placeholder="格式：1980-01-01"
											maxlength="10" id="startTime" /></td>
										<td style="width: 40%"><input type="date" name="toTime" value=""
											class="form-control required" placeholder="格式：1980-01-01"
											maxlength="10" id="endTime" /></td>
									</tr>
								</table></td>
							<td style="width: 10%"></td>
						</tr>
						<tr>
						<td style="width: 3%"></td>
							<td style="width: 38%">
								<table border="0" style="width: 100%">
									<tr>
										<td style="width: 20%">乘机人：</td>
										<td style="width: 80%"><input class="form-control input-small input-inline"
											name="passengerName" id="name" ></td>
									</tr>
								</table>
							</td>
							<td style="width: 6%"></td>
							<td style="width: 38%">
								<table border="0" style="width: 100%;height: 100%">
									<tr>
										<td style="width: 20%">订单状态：</td>
										<td style="width: 80%"><select name="status" id="status" class="form-control required">
												<option value="">不限</option>
												<option value="100">等待出票</option>
												<option value="104">出票成功</option>
												<option value="105">出票失败</option>
												<option value="106">等待退票</option>
												<option value="110">退票成功</option>
												<option value="111">退票失败</option>
												<option value="112">订单作废</option>
										</select></td>
									</tr>
								</table>
							</td>
							<td style="width: 10%"></td>
						</tr>
					</table>

					<div class="col-md-4 text-right" style="float: right;">
						<button class="btn btn-sm yellow filter-submit margin-bottom"
							target="search" data-ref="#orderGrid"
							data-ref-param="" onclick="checkTime();" id="check">
							查询</button>
					</div>
				</div>
				<table class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th>订单号</th>
							<th>公司名称</th> 
							<th>乘机人</th>
							<th>航程</th>
							<th>下单时间</th>
							<th>订单状态</th>
							<th>支付价</th>
							<th>退款金额</th> 
							<#if role == "success">
							<th>供应商价</th> </#if>
							<th>订票人</th>
							<th class="text-center">操作</th>
						</tr>
					</thead>
					<tbody id="orderGrid" target="grid"
						data-url="${contextPath}/view/orderList">
						<tr class="odd gradeX">
							<td>{orderNO}</td>
							<td>{companyName}</td>
							<td>{passengerName}</td>
							<td>航班:{flightNO}<br> {orgCity}-{dstCity}<br>
								{startDate}
							</td>
							<td>{dateTime}</td>
							<td>{statusMSG}</td>
							<td>{platTotalPrice}</td>
							<td>{refundPrice}</td> <#if role == "success">
							<td>{totalPrice}{failed}</td> </#if>
							<td>{userName}</td>
							<td class="text-center"><a class="btn default btn-xs blue"
								href="${contextPath}/view/orderDetail?orderID={id}&orderType={orderType}"
								target="hgTab"> 订单详情 </a></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
<script>
function checkTime(){
	 $("#check").attr("data-ref-param","");
	 var startDate=$("#startDate").val();  
	 var endDate=$("#endDate").val();  
	 var d1 = new Date(startDate.replace(/\-/g, "\/"));  
	 var d2 = new Date(endDate.replace(/\-/g, "\/"));  
	  
	  if(startDate!=""&&endDate!=""&&d1 >d2)  
	 {  
	  alert("开始时间不能大于结束时间！");  
	  return;  
	 }
	  var startTime=$("#startTime").val();  
	  var endTime=$("#endTime").val();  
	  var d1 = new Date(startTime.replace(/\-/g, "\/"));  
	  var d2 = new Date(endTime.replace(/\-/g, "\/"));  
	   
	   if(startTime!=""&&endTime!=""&&d1 >d2)  
	  {  
	   alert("开始时间不能大于结束时间！");  
	   return;  
	  }
	  
	  $("#check").attr("data-ref-param","{passengerName: $('#name').val(),startDate:$('#startDate').val(),endDate:$('#endDate').val(),"+
		  "inTime:$('#startTime').val(),toTime:$('#endTime').val(),status:$('#status').val()}");
}
</script>