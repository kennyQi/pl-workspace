(function(){function B(T){T.fn._fadeIn=T.fn.fadeIn;var a=T.noop||function(){};var R=/MSIE/.test(navigator.userAgent);var c=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var V=document.documentMode||0;var W=T.isFunction(document.createElement("div").style.setExpression);T.blockUI=function(C){d(window,C)};T.unblockUI=function(C){X(window,C)};T.growlUI=function(F,G,C,I){var D=T('<div class="growlUI"></div>');if(F){D.append("<h1>"+F+"</h1>")}if(G){D.append("<h2>"+G+"</h2>")}if(C===undefined){C=3000}var H=function(J){J=J||{};T.blockUI({message:D,fadeIn:typeof J.fadeIn!=="undefined"?J.fadeIn:700,fadeOut:typeof J.fadeOut!=="undefined"?J.fadeOut:1000,timeout:typeof J.timeout!=="undefined"?J.timeout:C,centerY:false,showOverlay:false,onUnblock:I,css:T.blockUI.defaults.growlCSS})};H();var E=D.css("opacity");D.mouseover(function(){H({fadeIn:0,timeout:30000});var J=T(".blockMsg");J.stop();J.fadeTo(300,1)}).mouseout(function(){T(".blockMsg").fadeOut(1000)})};T.fn.block=function(C){if(this[0]===window){T.blockUI(C);return this}var D=T.extend({},T.blockUI.defaults,C||{});this.each(function(){var E=T(this);if(D.ignoreIfBlocked&&E.data("blockUI.isBlocked")){return}E.unblock({fadeOut:0})});return this.each(function(){if(T.css(this,"position")=="static"){this.style.position="inherit";T(this).data("blockUI.static",true)}this.style.zoom=1;d(this,C)})};T.fn.unblock=function(C){if(this[0]===window){T.unblockUI(C);return this}return this.each(function(){X(this,C)})};T.blockUI.version=2.66;T.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"45%",textAlign:"center",color:"#000",border:"1px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1000,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var S=null;var A=[];function d(L,H){var w,J;var q=(L==window);var I=(H&&H.message!==undefined?H.message:undefined);H=T.extend({},T.blockUI.defaults,H||{});if(H.ignoreIfBlocked&&T(L).data("blockUI.isBlocked")){return}H.overlayCSS=T.extend({},T.blockUI.defaults.overlayCSS,H.overlayCSS||{});w=T.extend({},T.blockUI.defaults.css,H.css||{});if(H.onOverlayClick){H.overlayCSS.cursor="pointer"}J=T.extend({},T.blockUI.defaults.themedCSS,H.themedCSS||{});I=I===undefined?H.message:I;if(q&&S){X(window,{fadeOut:0})}if(I&&typeof I!="string"&&(I.parentNode||I.jquery)){var l=I.jquery?I[0]:I;var E={};T(L).data("blockUI.history",E);E.el=l;E.parent=l.parentNode;E.display=l.style.display;E.position=l.style.position;if(E.parent){E.parent.removeChild(l)}}T(L).data("blockUI.onUnblock",H.onUnblock);var s=H.baseZ;var v,Q,M,x;if(R||H.forceIframe){v=T('<iframe class="blockUI" style="z-index:'+(s++)+';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+H.iframeSrc+'"></iframe>')}else{v=T('<div class="blockUI" style="display:none"></div>')}if(H.theme){Q=T('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+(s++)+';display:none"></div>')}else{Q=T('<div class="blockUI blockOverlay" style="z-index:'+(s++)+';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>')}if(H.theme&&q){x='<div class="blockUI '+H.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(s+10)+';display:none;position:fixed">';if(H.title){x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(H.title||"&nbsp;")+"</div>"}x+='<div class="ui-widget-content ui-dialog-content"></div>';x+="</div>"}else{if(H.theme){x='<div class="blockUI '+H.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(s+10)+';display:none;position:absolute">';if(H.title){x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(H.title||"&nbsp;")+"</div>"}x+='<div class="ui-widget-content ui-dialog-content"></div>';x+="</div>"}else{if(q){x='<div class="blockUI '+H.blockMsgClass+' blockPage" style="z-index:'+(s+10)+';display:none;position:fixed"></div>'}else{x='<div class="blockUI '+H.blockMsgClass+' blockElement" style="z-index:'+(s+10)+';display:none;position:absolute"></div>'}}}M=T(x);if(I){if(H.theme){M.css(J);M.addClass("ui-widget-content")}else{M.css(w)}}if(!H.theme){Q.css(H.overlayCSS)}Q.css("position",q?"fixed":"absolute");if(R||H.forceIframe){v.css("opacity",0)}var r=[v,Q,M],N=q?T("body"):T(L);T.each(r,function(){this.appendTo(N)});if(H.theme&&H.draggable&&T.fn.draggable){M.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var G=W&&(!T.support.boxModel||T("object,embed",q?null:L).length>0);if(c||G){if(q&&H.allowBodyStretch&&T.support.boxModel){T("html,body").css("height","100%")}if((c||!T.support.boxModel)&&!q){var P=Y(L,"borderTopWidth"),D=Y(L,"borderLeftWidth");var O=P?"(0 - "+P+")":0;var F=D?"(0 - "+D+")":0}T.each(r,function(h,g){var j=g[0].style;j.position="absolute";if(h<2){if(q){j.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+H.quirksmodeOffsetHack+') + "px"')}else{j.setExpression("height",'this.parentNode.offsetHeight + "px"')}if(q){j.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"')}else{j.setExpression("width",'this.parentNode.offsetWidth + "px"')}if(F){j.setExpression("left",F)}if(O){j.setExpression("top",O)}}else{if(H.centerY){if(q){j.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"')}j.marginTop=0}else{if(!H.centerY&&q){var k=(H.css&&H.css.top)?parseInt(H.css.top,10):0;var m="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+k+') + "px"';j.setExpression("top",m)}}}})}if(I){if(H.theme){M.find(".ui-widget-content").append(I)}else{M.append(I)}if(I.jquery||I.nodeType){T(I).show()}}if((R||H.forceIframe)&&H.showOverlay){v.show()}if(H.fadeIn){var C=H.onBlock?H.onBlock:a;var K=(H.showOverlay&&!I)?C:a;var u=I?C:a;if(H.showOverlay){Q._fadeIn(H.fadeIn,K)}if(I){M._fadeIn(H.fadeIn,u)}}else{if(H.showOverlay){Q.show()}if(I){M.show()}if(H.onBlock){H.onBlock()}}b(1,L,H);if(q){S=M[0];A=T(H.focusableElements,S);if(H.focusInput){setTimeout(e,20)}}else{f(M[0],H.centerX,H.centerY)}if(H.timeout){var t=setTimeout(function(){if(q){T.unblockUI(H)}else{T(L).unblock(H)}},H.timeout);T(L).data("blockUI.timeout",t)}}function X(G,H){var E;var I=(G==window);var D=T(G);var F=D.data("blockUI.history");var C=D.data("blockUI.timeout");if(C){clearTimeout(C);D.removeData("blockUI.timeout")}H=T.extend({},T.blockUI.defaults,H||{});b(0,G,H);if(H.onUnblock===null){H.onUnblock=D.data("blockUI.onUnblock");D.removeData("blockUI.onUnblock")}var J;if(I){J=T("body").children().filter(".blockUI").add("body > .blockUI")}else{J=D.find(">.blockUI")}if(H.cursorReset){if(J.length>1){J[1].style.cursor=H.cursorReset}if(J.length>2){J[2].style.cursor=H.cursorReset}}if(I){S=A=null}if(H.fadeOut){E=J.length;J.stop().fadeOut(H.fadeOut,function(){if(--E===0){Z(J,F,H,G)}})}else{Z(J,F,H,G)}}function Z(F,E,G,I){var C=T(I);if(C.data("blockUI.isBlocked")){return}F.each(function(K,L){if(this.parentNode){this.parentNode.removeChild(this)}});if(E&&E.el){E.el.style.display=E.display;E.el.style.position=E.position;if(E.parent){E.parent.appendChild(E.el)}C.removeData("blockUI.history")}if(C.data("blockUI.static")){C.css("position","static")}if(typeof G.onUnblock=="function"){G.onUnblock(I,G)}var D=T(document.body),J=D.width(),H=D[0].style.width;D.width(J-1).width(J);D[0].style.width=H}function b(G,C,D){var F=C==window,H=T(C);if(!G&&(F&&!S||!F&&!H.data("blockUI.isBlocked"))){return}H.data("blockUI.isBlocked",G);if(!F||!D.bindEvents||(G&&!D.showOverlay)){return}var E="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(G){T(document).bind(E,D,U)}else{T(document).unbind(E,U)}}function U(D){if(D.type==="keydown"&&D.keyCode&&D.keyCode==9){if(S&&D.data.constrainTabKey){var H=A;var F=!D.shiftKey&&D.target===H[H.length-1];var C=D.shiftKey&&D.target===H[0];if(F||C){setTimeout(function(){e(C)},10);return false}}}var G=D.data;var E=T(D.target);if(E.hasClass("blockOverlay")&&G.onOverlayClick){G.onOverlayClick(D)}if(E.parents("div."+G.blockMsgClass).length>0){return true}return E.parents().children().filter("div.blockUI").length===0}function e(C){if(!A){return}var D=A[C===true?A.length-1:0];if(D){D.focus()}}function f(C,F,G){var H=C.parentNode,D=C.style;var I=((H.offsetWidth-C.offsetWidth)/2)-Y(H,"borderLeftWidth");var E=((H.offsetHeight-C.offsetHeight)/2)-Y(H,"borderTopWidth");if(F){D.left=I>0?(I+"px"):"0"}if(G){D.top=E>0?(E+"px"):"0"}}function Y(C,D){return parseInt(T.css(C,D),10)||0}}if(typeof define==="function"&&define.amd&&define.amd.jQuery){define(["jquery"],B)}else{B(jQuery)}})();(function(){var D,C=window.Messenger;D=window.Messenger=function(){return D._call.apply(this,arguments)},window.Messenger.noConflict=function(){return window.Messenger=C,D}})(),window.Messenger._=function(){if(window._){return window._}var U=Array.prototype,Y=Object.prototype,P=Function.prototype,S=(U.push,U.slice),X=(U.concat,Y.toString);Y.hasOwnProperty;var O=U.forEach,Z=(U.map,U.reduce,U.reduceRight,U.filter),R=(U.every,U.some,U.indexOf,U.lastIndexOf,Array.isArray,Object.keys),N=P.bind,V={},Q={},W=V.each=V.forEach=function(E,D,C){if(null!=E){if(O&&E.forEach===O){E.forEach(D,C)}else{if(E.length===+E.length){for(var F=0,B=E.length;B>F;F++){if(D.call(C,E[F],F,E)===Q){return}}}else{for(var A in E){if(V.has(E,A)&&D.call(C,E[A],A,E)===Q){return}}}}}};V.result=function(B,C){if(null==B){return null}var A=B[C];return V.isFunction(A)?A.call(B):A},V.once=function(B){var C,A=!1;return function(){return A?C:(A=!0,C=B.apply(this,arguments),B=null,C)}};var T=0;return V.uniqueId=function(A){var B=++T+"";return A?A+B:B},V.filter=V.select=function(B,D,C){var A=[];return null==B?A:Z&&B.filter===Z?B.filter(D,C):(W(B,function(F,E,G){D.call(C,F,E,G)&&(A[A.length]=F)}),A)},W(["Arguments","Function","String","Number","Date","RegExp"],function(A){V["is"+A]=function(B){return X.call(B)=="[object "+A+"]"}}),V.defaults=function(A){return W(S.call(arguments,1),function(C){if(C){for(var B in C){null==A[B]&&(A[B]=C[B])}}}),A},V.extend=function(A){return W(S.call(arguments,1),function(C){if(C){for(var B in C){A[B]=C[B]}}}),A},V.keys=R||function(B){if(B!==Object(B)){throw new TypeError("Invalid object")}var C=[];for(var A in B){V.has(B,A)&&(C[C.length]=A)}return C},V.bind=function(B,C){if(B.bind===N&&N){return N.apply(B,S.call(arguments,1))}var A=S.call(arguments,2);return function(){return B.apply(C,A.concat(S.call(arguments)))}},V.isObject=function(A){return A===Object(A)},V}(),window.Messenger.Events=function(){if(window.Backbone&&Backbone.Events){return Backbone.Events}var B=function(){var G=/\s+/,F=function(D,R,Q,P){if(!Q){return !0}if("object"==typeof Q){for(var E in Q){D[R].apply(D,[E,Q[E]].concat(P))}}else{if(!G.test(Q)){return !0}for(var C=Q.split(G),O=0,N=C.length;N>O;O++){D[R].apply(D,[C[O]].concat(P))}}},H=function(D,L){var C,E=-1,K=D.length;switch(L.length){case 0:for(;K>++E;){(C=D[E]).callback.call(C.ctx)}return;case 1:for(;K>++E;){(C=D[E]).callback.call(C.ctx,L[0])}return;case 2:for(;K>++E;){(C=D[E]).callback.call(C.ctx,L[0],L[1])}return;case 3:for(;K>++E;){(C=D[E]).callback.call(C.ctx,L[0],L[1],L[2])}return;default:for(;K>++E;){(C=D[E]).callback.apply(C.ctx,L)}}},A={on:function(D,C,E){if(!F(this,"on",D,[C,E])||!C){return this}this._events||(this._events={});var J=this._events[D]||(this._events[D]=[]);return J.push({callback:C,context:E,ctx:E||this}),this},once:function(D,C,E){if(!F(this,"once",D,[C,E])||!C){return this}var K=this,L=_.once(function(){K.off(D,L),C.apply(this,arguments)});return L._callback=C,this.on(D,L,E),this},off:function(U,S,V){var D,C,T,W,Q,E,R,X;if(!this._events||!F(this,"off",U,[S,V])){return this}if(!U&&!S&&!V){return this._events={},this}for(W=U?[U]:_.keys(this._events),Q=0,E=W.length;E>Q;Q++){if(U=W[Q],D=this._events[U]){if(T=[],S||V){for(R=0,X=D.length;X>R;R++){C=D[R],(S&&S!==C.callback&&S!==C.callback._callback||V&&V!==C.context)&&T.push(C)}}this._events[U]=T}}return this},trigger:function(D){if(!this._events){return this}var C=Array.prototype.slice.call(arguments,1);if(!F(this,"trigger",D,C)){return this}var E=this._events[D],J=this._events.all;return E&&H(E,C),J&&H(J,arguments),this},listenTo:function(D,L,C){var E=this._listeners||(this._listeners={}),K=D._listenerId||(D._listenerId=_.uniqueId("l"));return E[K]=D,D.on(L,"object"==typeof L?this:C,this),this},stopListening:function(D,L,C){var E=this._listeners;if(E){if(D){D.off(L,"object"==typeof L?this:C,this),L||C||delete E[D._listenerId]}else{"object"==typeof L&&(C=this);for(var K in E){E[K].off(L,C,this)}this._listeners={}}return this}}};return A.bind=A.on,A.unbind=A.off,A};return B()}(),function(){var Y,c,R,W,b,Q,d,V,P,Z,U,a={}.hasOwnProperty,X=function(C,B){function D(){this.constructor=C}for(var A in B){a.call(B,A)&&(C[A]=B[A])}return D.prototype=B.prototype,C.prototype=new D,C.__super__=B.prototype,C},T=[].slice,S=[].indexOf||function(B){for(var A=0,C=this.length;C>A;A++){if(A in this&&this[A]===B){return A}}return -1};Y=jQuery,Q=null!=(P=window._)?P:window.Messenger._,W=null!=(Z="undefined"!=typeof Backbone&&null!==Backbone?Backbone.Events:void 0)?Z:window.Messenger.Events,R=function(){function A(B){Y.extend(this,W),Q.isObject(B)&&(B.el&&this.setElement(B.el),this.model=B.model),this.initialize.apply(this,arguments)}return A.prototype.setElement=function(B){return this.$el=Y(B),this.el=this.$el[0]},A.prototype.delegateEvents=function(E){var H,I,C,D,F,B,G;if(E||(E=Q.result(this,"events"))){H=/^(\S+)\s*(.*)$/,this.undelegateEvents(),G=[];for(C in E){if(F=E[C],Q.isFunction(F)||(F=this[E[C]]),!F){throw Error("Method "+E[C]+" does not exist")}D=C.match(H),I=D[1],B=D[2],F=Q.bind(F,this),I+=".delegateEvents"+this.cid,""===B?G.push(this.jqon(I,F)):G.push(this.jqon(I,B,F))}return G}},A.prototype.jqon=function(D,E,B){var C;return null!=this.$el.on?(C=this.$el).on.apply(C,arguments):(null==B&&(B=E,E=void 0),null!=E?this.$el.delegate(E,D,B):this.$el.bind(D,B))},A.prototype.jqoff=function(C){var B;return null!=this.$el.off?(B=this.$el).off.apply(B,arguments):(this.$el.undelegate(),this.$el.unbind(C))},A.prototype.undelegateEvents=function(){return this.jqoff(".delegateEvents"+this.cid)},A.prototype.remove=function(){return this.undelegateEvents(),this.$el.remove()},A}(),d=function(B){function A(){return A.__super__.constructor.apply(this,arguments)}return X(A,B),A.prototype.defaults={hideAfter:10,scroll:!0},A.prototype.initialize=function(C){return null==C&&(C={}),this.shown=!1,this.rendered=!1,this.messenger=C.messenger,this.options=Y.extend({},this.options,C,this.defaults)},A.prototype.show=function(){var C;return this.rendered||this.render(),this.$message.removeClass("messenger-hidden"),C=this.shown,this.shown=!0,C?void 0:this.trigger("show")},A.prototype.hide=function(){var C;if(this.rendered){return this.$message.addClass("messenger-hidden"),C=this.shown,this.shown=!1,C?this.trigger("hide"):void 0}},A.prototype.cancel=function(){return this.hide()},A.prototype.update=function(E){var C,D=this;return Q.isString(E)&&(E={message:E}),Y.extend(this.options,E),this.lastUpdate=new Date,this.rendered=!1,this.events=null!=(C=this.options.events)?C:{},this.render(),this.actionsToEvents(),this.delegateEvents(),this.checkClickable(),this.options.hideAfter?(this.$message.addClass("messenger-will-hide-after"),null!=this._hideTimeout&&clearTimeout(this._hideTimeout),this._hideTimeout=setTimeout(function(){return D.hide()},1000*this.options.hideAfter)):this.$message.removeClass("messenger-will-hide-after"),this.options.hideOnNavigate?(this.$message.addClass("messenger-will-hide-on-navigate"),null!=("undefined"!=typeof Backbone&&null!==Backbone?Backbone.history:void 0)&&Backbone.history.on("route",function(){return D.hide()})):this.$message.removeClass("messenger-will-hide-on-navigate"),this.trigger("update",this)},A.prototype.scrollTo=function(){return this.options.scroll?Y.scrollTo(this.$el,{duration:400,offset:{left:0,top:-20}}):void 0},A.prototype.timeSinceUpdate=function(){return this.lastUpdate?new Date-this.lastUpdate:null},A.prototype.actionsToEvents=function(){var D,E,F,G,C=this;F=this.options.actions,G=[];for(E in F){D=F[E],G.push(this.events['click [data-action="'+E+'"] a']=function(H){return function(I){return I.preventDefault(),I.stopPropagation(),C.trigger("action:"+E,H,I),H.action.call(C,I,C)}}(D))}return G},A.prototype.checkClickable=function(){var C,F,D,E;D=this.events,E=[];for(F in D){C=D[F],"click"===F?E.push(this.$message.addClass("messenger-clickable")):E.push(void 0)}return E},A.prototype.undelegateEvents=function(){var C;return A.__super__.undelegateEvents.apply(this,arguments),null!=(C=this.$message)?C.removeClass("messenger-clickable"):void 0},A.prototype.parseActions=function(){var F,D,G,C,H,E;D=[],H=this.options.actions;for(C in H){F=H[C],G=Y.extend({},F),G.name=C,null==(E=G.label)&&(G.label=C),D.push(G)}return D},A.prototype.template=function(M){var F,H,G,E,D,C,I,J,N,K,L=this;for(D=Y("<div class='messenger-message message alert "+M.type+" message-"+M.type+" alert-"+M.type+"'>"),M.showCloseButton&&(G=Y('<button type="button" class="close" data-dismiss="alert">&times;</button>'),G.click(function(){return L.cancel(),!0}),D.append(G)),C=Y('<div class="messenger-message-inner">'+M.message+"</div>"),D.append(C),M.actions.length&&(H=Y('<div class="messenger-actions">')),K=M.actions,J=0,N=K.length;N>J;J++){I=K[J],F=Y("<span>"),F.attr("data-action",""+I.name),E=Y("<a>"),E.html(I.label),F.append(Y('<span class="messenger-phrase">')),F.append(E),H.append(F)}return D.append(H),D},A.prototype.render=function(){var C;if(!this.rendered){return this._hasSlot||(this.setElement(this.messenger._reserveMessageSlot(this)),this._hasSlot=!0),C=Y.extend({},this.options,{actions:this.parseActions()}),this.$message=Y(this.template(C)),this.$el.html(this.$message),this.shown=!0,this.rendered=!0,this.trigger("render")}},A}(R),b=function(A){function B(){return B.__super__.constructor.apply(this,arguments)}return X(B,A),B.prototype.initialize=function(){return B.__super__.initialize.apply(this,arguments),this._timers={}},B.prototype.cancel=function(){return this.clearTimers(),this.hide(),null!=this._actionInstance&&null!=this._actionInstance.abort?this._actionInstance.abort():void 0},B.prototype.clearTimers=function(){var C,F,D,E;D=this._timers;for(C in D){F=D[C],clearTimeout(F)}return this._timers={},null!=(E=this.$message)?E.removeClass("messenger-retry-soon messenger-retry-later"):void 0},B.prototype.render=function(){var D,E,F,C;B.__super__.render.apply(this,arguments),this.clearTimers(),F=this.options.actions,C=[];for(E in F){D=F[E],D.auto?C.push(this.startCountdown(E,D)):C.push(void 0)}return C},B.prototype.renderPhrase=function(C,E){var D;return D=C.phrase.replace("TIME",this.formatTime(E))},B.prototype.formatTime=function(C){var D;return D=function(E,F){return E=Math.floor(E),1!==E&&(F+="s"),"in "+E+" "+F},0===Math.floor(C)?"now...":60>C?D(C,"second"):(C/=60,60>C?D(C,"minute"):(C/=60,D(C,"hour")))},B.prototype.startCountdown=function(D,G){var H,I,C,F,E=this;if(null==this._timers[D]){return H=this.$message.find("[data-action='"+D+"'] .messenger-phrase"),I=null!=(F=G.delay)?F:3,10>=I?(this.$message.removeClass("messenger-retry-later"),this.$message.addClass("messenger-retry-soon")):(this.$message.removeClass("messenger-retry-soon"),this.$message.addClass("messenger-retry-later")),C=function(){var J;return H.text(E.renderPhrase(G,I)),I>0?(J=Math.min(I,1),I-=J,E._timers[D]=setTimeout(C,1000*J)):(E.$message.removeClass("messenger-retry-soon messenger-retry-later"),delete E._timers[D],G.action())},C()}},B}(d),V=function(B){function A(){return A.__super__.constructor.apply(this,arguments)}return X(A,B),A.prototype.tagName="ul",A.prototype.className="messenger",A.prototype.messageDefaults={type:"info"},A.prototype.initialize=function(C){return this.options=null!=C?C:{},this.history=[],this.messageDefaults=Y.extend({},this.messageDefaults,this.options.messageDefaults)},A.prototype.render=function(){return this.updateMessageSlotClasses()},A.prototype.findById=function(C){return Q.filter(this.history,function(D){return D.msg.options.id===C})},A.prototype._reserveMessageSlot=function(F){var D,E,C=this;for(D=Y("<li>"),D.addClass("messenger-message-slot"),this.$el.prepend(D),this.history.push({msg:F,$slot:D}),this._enforceIdConstraint(F),F.on("update",function(){return C._enforceIdConstraint(F)});this.options.maxMessages&&this.history.length>this.options.maxMessages;){E=this.history.shift(),E.msg.remove(),E.$slot.remove()}return D},A.prototype._enforceIdConstraint=function(D){var F,G,H,C,E;if(null!=D.options.id){for(E=this.history,G=0,H=E.length;H>G;G++){if(F=E[G],C=F.msg,null!=C.options.id&&C.options.id===D.options.id&&D!==C){if(D.options.singleton){return D.hide(),void 0}C.hide()}}}},A.prototype.newMessage=function(D){var E,G,H,C,F=this;return null==D&&(D={}),D.messenger=this,d=null!=(G=null!=(H=Messenger.themes[null!=(C=D.theme)?C:this.options.theme])?H.Message:void 0)?G:b,E=new d(D),E.on("show",function(){return D.scrollTo&&"fixed"!==F.$el.css("position")?E.scrollTo():void 0}),E.on("hide show render",this.updateMessageSlotClasses,this),E},A.prototype.updateMessageSlotClasses=function(){var D,G,H,I,C,F,E;for(I=!0,G=null,D=!1,E=this.history,C=0,F=E.length;F>C;C++){H=E[C],H.$slot.removeClass("messenger-first messenger-last messenger-shown"),H.msg.shown&&H.msg.rendered&&(H.$slot.addClass("messenger-shown"),D=!0,G=H,I&&(I=!1,H.$slot.addClass("messenger-first")))}return null!=G&&G.$slot.addClass("messenger-last"),this.$el[""+(D?"remove":"add")+"Class"]("messenger-empty")},A.prototype.hideAll=function(){var D,E,F,G,C;for(G=this.history,C=[],E=0,F=G.length;F>E;E++){D=G[E],C.push(D.msg.hide())}return C},A.prototype.post=function(D){var C;return Q.isString(D)&&(D={message:D}),D=Y.extend(!0,{},this.messageDefaults,D),C=this.newMessage(D),C.update(D),C},A}(R),c=function(B){function A(){return A.__super__.constructor.apply(this,arguments)}return X(A,B),A.prototype.doDefaults={progressMessage:null,successMessage:null,errorMessage:"Error connecting to the server.",showSuccessWithoutError:!0,retry:{auto:!0,allow:!0},action:Y.ajax},A.prototype.hookBackboneAjax=function(E){var C,D=this;if(null==E&&(E={}),null==window.Backbone){throw"Expected Backbone to be defined"}return E=Q.defaults(E,{id:"BACKBONE_ACTION",errorMessage:!1,successMessage:"Request completed successfully.",showSuccessWithoutError:!1}),C=function(G){var F;return F=Q.extend({},E,G.messenger),D["do"](F,G)},null!=Backbone.ajax?(Backbone.ajax._withoutMessenger&&(Backbone.ajax=Backbone.ajax._withoutMessenger),(null==E.action||E.action===this.doDefaults.action)&&(E.action=Backbone.ajax),C._withoutMessenger=Backbone.ajax,Backbone.ajax=C):Backbone.sync=Q.wrap(Backbone.sync,function(){var G,F,H;return H=arguments[0],G=arguments.length>=2?T.call(arguments,1):[],F=Y.ajax,Y.ajax=C,H.call.apply(H,[this].concat(T.call(G))),Y.ajax=F})},A.prototype._getHandlerResponse=function(C){return C===!1?!1:C===!0||null==C?!0:C},A.prototype._parseEvents=function(E){var J,H,F,I,G,C,D;null==E&&(E={}),G={};for(I in E){F=E[I],H=I.indexOf(" "),C=I.substring(0,H),J=I.substring(H+1),null==(D=G[C])&&(G[C]={}),G[C][J]=F}return G},A.prototype._normalizeResponse=function(){var D,G,H,I,C,F,E;for(H=arguments.length>=1?T.call(arguments,0):[],I=null,C=null,D=null,F=0,E=H.length;E>F;F++){G=H[F],"success"===G||"timeout"===G||"abort"===G?I=G:null!=(null!=G?G.readyState:void 0)&&null!=(null!=G?G.responseText:void 0)?C=G:Q.isObject(G)&&(D=G)}return[I,D,C]},A.prototype.run=function(){var C,E,m,J,K,I,O,l,M,H,N,F,g,D,h,G,L=this;if(O=arguments[0],H=arguments[1],C=arguments.length>=3?T.call(arguments,2):[],null==H&&(H={}),O=Y.extend(!0,{},this.messageDefaults,this.doDefaults,null!=O?O:{}),m=this._parseEvents(O.events),J=function(j,e){var f;return f=O[j+"Message"],Q.isFunction(f)?f.call(L,j,e):f},l=null!=(h=O.messageInstance)?h:this.newMessage(O),null!=O.id&&(l.options.id=O.id),null!=O.progressMessage&&l.update(Y.extend({},O,{message:J("progress",null),type:"info"})),I={},Q.each(["error","success"],function(f){var e;return e=H[f],I[f]=function(){var Aj,x,Ag,Aa,q,Ad,Ak,v,Ah,j,Af,p,k,y,Ai;return Ad=arguments.length>=1?T.call(arguments,0):[],Ah=L._normalizeResponse.apply(L,Ad),q=Ah[0],Aj=Ah[1],v=Ah[2],"success"===f&&null==l.errorCount&&O.showSuccessWithoutError===!1&&(O.successMessage=null),"error"===f&&(null==(j=O.errorCount)&&(O.errorCount=0),O.errorCount+=1),Ag=O.returnsPromise?Ad[0]:"function"==typeof e?e.apply(null,Ad):void 0,Ak=L._getHandlerResponse(Ag),Q.isString(Ak)&&(Ak={message:Ak}),"error"!==f||0!==(null!=v?v.status:void 0)&&"abort"!==q?"error"===f&&null!=O.ignoredErrorCodes&&(Af=null!=v?v.status:void 0,S.call(O.ignoredErrorCodes,Af)>=0)?(l.hide(),void 0):(x={message:J(f,v),type:f,events:null!=(p=m[f])?p:{},hideOnNavigate:"success"===f},Aa=Y.extend({},O,x,Ak),"number"==typeof(null!=(k=Aa.retry)?k.allow:void 0)&&Aa.retry.allow--,"error"===f&&(null!=v?v.status:void 0)>=500&&(null!=(y=Aa.retry)?y.allow:void 0)?(null==Aa.retry.delay&&(Aa.retry.delay=4>Aa.errorCount?10:300),Aa.hideAfter&&(null==(Ai=Aa._hideAfter)&&(Aa._hideAfter=Aa.hideAfter),Aa.hideAfter=Aa._hideAfter+Aa.retry.delay),Aa._retryActions=!0,Aa.actions={retry:{label:"retry now",phrase:"Retrying TIME",auto:Aa.retry.auto,delay:Aa.retry.delay,action:function(){return Aa.messageInstance=l,setTimeout(function(){return L["do"].apply(L,[Aa,H].concat(T.call(C)))},0)}},cancel:{action:function(){return l.cancel()}}}):Aa._retryActions&&(delete Aa.actions.retry,delete Aa.actions.cancel,delete O._retryActions),l.update(Aa),Ak&&Aa.message?(Messenger(),l.show()):l.hide()):(l.hide(),void 0)}}),!O.returnsPromise){for(F in I){K=I[F],M=H[F],H[F]=K}}for(l._actionInstance=O.action.apply(O,[H].concat(T.call(C))),O.returnsPromise&&l._actionInstance.then(I.success,I.error),N=["done","progress","fail","state","then"],g=0,D=N.length;D>g;g++){E=N[g],null!=l[E]&&delete l[E],l[E]=null!=(G=l._actionInstance)?G[E]:void 0}return l},A.prototype["do"]=A.prototype.run,A.prototype.ajax=function(){var D,C;return C=arguments[0],D=arguments.length>=2?T.call(arguments,1):[],C.action=Y.ajax,this.run.apply(this,[C].concat(T.call(D)))},A.prototype.expectPromise=function(C,D){return D=Q.extend({},D,{action:C,returnsPromise:!0}),this.run(D)},A}(V),Y.fn.messenger=function(){var G,D,C,H,E,A,F,B;return C=arguments[0],D=arguments.length>=2?T.call(arguments,1):[],null==C&&(C={}),G=this,null!=C&&Q.isString(C)?(B=G.data("messenger"))[C].apply(B,D):(E=C,null==G.data("messenger")&&(V=null!=(A=null!=(F=Messenger.themes[E.theme])?F.Messenger:void 0)?A:c,G.data("messenger",H=new V(Y.extend({el:G},E))),H.render()),G.data("messenger"))},window.Messenger._call=function(E){var I,G,J,H,B,F,C,L,A,K,D;if(F={extraClasses:"messenger-fixed messenger-on-bottom messenger-on-right",theme:"future",maxMessages:9,parentLocations:["body"]},E=Y.extend(F,Y._messengerDefaults,Messenger.options,E),null!=E.theme&&(E.extraClasses+=" messenger-theme-"+E.theme),C=E.instance||Messenger.instance,null==E.instance){for(A=E.parentLocations,G=null,J=null,K=0,D=A.length;D>K;K++){if(L=A[K],G=Y(L),G.length){H=L;break}}C?Y(C._location)!==Y(H)&&(C.$el.detach(),G.prepend(C.$el)):(I=Y("<ul>"),G.prepend(I),C=I.messenger(E),C._location=H,Messenger.instance=C)}return null!=C._addedClasses&&C.$el.removeClass(C._addedClasses),C.$el.addClass(B=""+C.className+" "+E.extraClasses),C._addedClasses=B,C},Y.extend(Messenger,{Message:b,Messenger:c,themes:null!=(U=Messenger.themes)?U:{}}),Y.globalMessenger=window.Messenger=Messenger}.call(this);(function(B){B.confirm=function(H){if(B("#confirmOverlay").length){return false}var A="";B.each(H.buttons,function(C,D){A+='<a href="#" class="button '+D["class"]+'">'+C+"<span></span></a>";if(!D.action){D.action=function(){}}});var J=['<div id="confirmOverlay">','<div id="confirmBox">',"<h1>",H.title,"</h1>","<p>",H.message,"</p>",'<div id="confirmButtons">',A,"</div></div></div>"].join("");B(J).hide().appendTo("body").fadeIn();var G=B("#confirmBox .button"),I=0;B.each(H.buttons,function(C,D){G.eq(I++).click(function(){D.action();B.confirm.hide();return false})})};B.confirm.hide=function(){B("#confirmOverlay").fadeOut(function(){B(this).remove()})}})(jQuery);(function(){function addEvent(el,type,fn){if(el.addEventListener){el.addEventListener(type,fn,false)}else{if(el.attachEvent){el.attachEvent("on"+type,function(){fn.call(el)})}else{throw new Error("not supported or DOM not loaded")}}}function addResizeEvent(fn){var timeout;addEvent(window,"resize",function(){if(timeout){clearTimeout(timeout)}timeout=setTimeout(fn,100)})}if(document.documentElement.getBoundingClientRect){var getOffset=function(el){var box=el.getBoundingClientRect();var doc=el.ownerDocument;var body=doc.body;var docElem=doc.documentElement;var clientTop=docElem.clientTop||body.clientTop||0;var clientLeft=docElem.clientLeft||body.clientLeft||0;var zoom=1;if(body.getBoundingClientRect){var bound=body.getBoundingClientRect();zoom=(bound.right-bound.left)/body.clientWidth}if(zoom>1){clientTop=0;clientLeft=0}var top=box.top/zoom+(window.pageYOffset||docElem&&docElem.scrollTop/zoom||body.scrollTop/zoom)-clientTop,left=box.left/zoom+(window.pageXOffset||docElem&&docElem.scrollLeft/zoom||body.scrollLeft/zoom)-clientLeft;return{top:top,left:left}}}else{var getOffset=function(el){var top=0,left=0;do{top+=el.offsetTop||0;left+=el.offsetLeft||0;el=el.offsetParent}while(el);return{left:left,top:top}}}function getBox(el){var left,right,top,bottom;var offset=getOffset(el);left=offset.left;top=offset.top;right=left+el.offsetWidth;bottom=top+el.offsetHeight;return{left:left,right:right,top:top,bottom:bottom}}function addStyles(el,styles){for(var name in styles){if(styles.hasOwnProperty(name)){el.style[name]=styles[name]}}}function copyLayout(from,to){var box=getBox(from);addStyles(to,{position:"absolute",left:box.left+"px",top:box.top+"px",width:from.offsetWidth+"px",height:from.offsetHeight+"px"})}var toElement=(function(){var div=document.createElement("div");return function(html){div.innerHTML=html;var el=div.firstChild;return div.removeChild(el)}})();var getUID=(function(){var id=0;return function(){return"ValumsAjaxUpload"+id++}})();function fileFromPath(file){return file.replace(/.*(\/|\\)/,"")}function getExt(file){return(-1!==file.indexOf("."))?file.replace(/.*[.]/,""):""}function hasClass(el,name){var re=new RegExp("\\b"+name+"\\b");return re.test(el.className)}function addClass(el,name){if(!hasClass(el,name)){el.className+=" "+name}}function removeClass(el,name){var re=new RegExp("\\b"+name+"\\b");el.className=el.className.replace(re,"")}function removeNode(el){el.parentNode.removeChild(el)}window.AjaxUpload=function(button,options){this._settings={action:"upload.php",name:"userfile",multiple:false,data:{},autoSubmit:true,responseType:false,hoverClass:"hover",focusClass:"focus",disabledClass:"disabled",onChange:function(file,extension){},onSubmit:function(file,extension){},onComplete:function(file,response){}};for(var i in options){if(options.hasOwnProperty(i)){this._settings[i]=options[i]}}if(button.jquery){button=button[0]}else{if(typeof button=="string"){if(/^#.*/.test(button)){button=button.slice(1)}button=document.getElementById(button)}}if(!button||button.nodeType!==1){throw new Error("Please make sure that you're passing a valid element")}if(button.nodeName.toUpperCase()=="A"){addEvent(button,"click",function(e){if(e&&e.preventDefault){e.preventDefault()}else{if(window.event){window.event.returnValue=false}}})}this._button=button;this._input=null;this._disabled=false;this.enable();this._rerouteClicks()};AjaxUpload.prototype={setData:function(data){this._settings.data=data},disable:function(){addClass(this._button,this._settings.disabledClass);this._disabled=true;var nodeName=this._button.nodeName.toUpperCase();if(nodeName=="INPUT"||nodeName=="BUTTON"){this._button.setAttribute("disabled","disabled")}if(this._input){if(this._input.parentNode){this._input.parentNode.style.visibility="hidden"}}},enable:function(){removeClass(this._button,this._settings.disabledClass);this._button.removeAttribute("disabled");this._disabled=false},_createInput:function(){var self=this;var input=document.createElement("input");input.setAttribute("type","file");input.setAttribute("name",this._settings.name);if(this._settings.multiple){input.setAttribute("multiple","multiple")}addStyles(input,{"position":"absolute","right":0,"margin":0,"padding":0,"fontSize":"480px","fontFamily":"sans-serif","cursor":"pointer"});var div=document.createElement("div");addStyles(div,{"display":"block","position":"absolute","overflow":"hidden","margin":0,"padding":0,"opacity":0,"direction":"ltr","zIndex":2147483583});if(div.style.opacity!=="0"){if(typeof(div.filters)=="undefined"){throw new Error("Opacity not supported by the browser")}div.style.filter="alpha(opacity=0)"}addEvent(input,"change",function(){if(!input||input.value===""){return}var file=fileFromPath(input.value);var fileSize=-1;try{var fso=new ActiveXObject("Scripting.FileSystemObject");fileSize=parseInt(fso.getFile(objValue).size)}catch(e){try{fileSize=parseInt(this.files[0].size)}catch(e){fileSize=-1}}if(false===self._settings.onChange.call(self,file,getExt(file),fileSize)){self._clearInput();return}if(self._settings.autoSubmit){self.action(file,getExt(file),fileSize)}});addEvent(input,"mouseover",function(){addClass(self._button,self._settings.hoverClass)});addEvent(input,"mouseout",function(){removeClass(self._button,self._settings.hoverClass);removeClass(self._button,self._settings.focusClass);if(input.parentNode){input.parentNode.style.visibility="hidden"}});addEvent(input,"focus",function(){addClass(self._button,self._settings.focusClass)});addEvent(input,"blur",function(){removeClass(self._button,self._settings.focusClass)});div.appendChild(input);document.body.appendChild(div);this._input=input},_clearInput:function(){if(!this._input){return}removeNode(this._input.parentNode);this._input=null;this._createInput();removeClass(this._button,this._settings.hoverClass);removeClass(this._button,this._settings.focusClass)},_rerouteClicks:function(){var self=this;addEvent(self._button,"mouseover",function(){if(self._disabled){return}if(!self._input){self._createInput()}var div=self._input.parentNode;copyLayout(self._button,div);div.style.visibility="visible"})},_createIframe:function(){var id=getUID();var iframe=toElement('<iframe src="javascript:false;" name="'+id+'" />');iframe.setAttribute("id",id);iframe.style.display="none";document.body.appendChild(iframe);return iframe},_createForm:function(iframe){var settings=this._settings;var form=toElement('<form method="post" enctype="multipart/form-data"></form>');if(settings.params){var params=settings.params,action=settings.action,cond="?";for(var p in params){action+=cond+p+"="+params[p];cond="&"}settings.action=action}form.setAttribute("action",settings.action);form.setAttribute("target",iframe.name);form.style.display="none";document.body.appendChild(form);for(var prop in settings.data){if(settings.data.hasOwnProperty(prop)){var el=document.createElement("input");el.setAttribute("type","hidden");el.setAttribute("name",prop);el.setAttribute("value",settings.data[prop]);form.appendChild(el)}}return form},_createProcess:function(){var process=$('<div class="progress progress-striped active"></div>');var processStatus=$('<div class="bar" style="width: 0%;"></div>');process.append(processStatus);this._process=process;this._processStatus=processStatus;return process},_getResponse:function(iframe,file,ext,fileSize){var toDeleteFlag=false,self=this,settings=this._settings;addEvent(iframe,"load",function(){if(iframe.src=="javascript:'%3Chtml%3E%3C/html%3E';"||iframe.src=="javascript:'<html></html>';"){if(toDeleteFlag){setTimeout(function(){removeNode(iframe)},0)}return}var doc;try{doc=iframe.contentDocument?iframe.contentDocument:window.frames[iframe.id].document}catch(e){if(e.code===18){settings.onComplete.call(self,file,null,fileSize);self.destroyProcess();toDeleteFlag=true}}if(doc.readyState&&doc.readyState!="complete"){return}if(doc.body&&doc.body.innerHTML=="false"){return}var response;if(doc.XMLDocument){response=doc.XMLDocument}else{if(doc.body){response=doc.body.innerHTML;if(settings.responseType&&settings.responseType.toLowerCase()=="json"){if(doc.body.firstChild&&doc.body.firstChild.nodeName.toUpperCase()=="PRE"){doc.normalize();response=doc.body.firstChild.firstChild.nodeValue}if(response){response=eval("("+response+")")}else{response={}}}}else{response=doc}}settings.onComplete.call(self,file,response,fileSize);self.destroyProcess();toDeleteFlag=true;iframe.src="javascript:'<html></html>';"})},updateProcess:function(){var self=this,settings=this._settings,process=this._process,processStatus=this._processStatus;this._processInterval=setInterval(function(){$.ajax({url:settings.processUrl,type:"GET",dataType:"html",success:function(html){if(html!=="0"){processStatus.css("width",html+"%")}}})},100)},destroyProcess:function(){var process=this._process,processStatus=this._processStatus,processInterval=this._processInterval;processStatus.css("width","100%");setTimeout(function(){clearInterval(processInterval);process.remove()},500)},action:function(file,ext,fileSize){var self=this,settings=this._settings;if(!this._input||this._input.value===""){return}this._createProcess();if(false===settings.onSubmit.call(this,file,ext,fileSize)){this._clearInput();return}this.updateProcess();var iframe=this._createIframe();var form=this._createForm(iframe);removeNode(this._input.parentNode);removeClass(self._button,self._settings.hoverClass);removeClass(self._button,self._settings.focusClass);form.appendChild(this._input);form.submit();removeNode(form);form=null;removeNode(this._input);this._input=null;this._getResponse(iframe,file,ext,fileSize);this._createInput()}}})();(function(E){function G(){this.isField=true,this.down=false,this.inFocus=false,this.disabled=false,this.cutOff=false,this.hasLabel=false,this.keyboardMode=false,this.nativeTouch=true,this.wrapperClass="dropdown",this.onChange=null}G.prototype={constructor:G,instances:[],init:function(C,B){var A=this;E.extend(A,B);A.$select=E(C);A.id=C.id;A.options=[];A.$options=A.$select.find("option");A.isTouch="ontouchend" in document;A.$select.removeClass(A.wrapperClass+" dropdown");if(A.$select.is(":disabled")){A.disabled=true}if(A.$options.length){A.$options.each(function(J){var D=E(this);if(D.is(":selected")){A.selected={index:J,title:D.text(),value:D[0].value};A.focusIndex=J}if(D.hasClass("label")&&J==0){A.hasLabel=true;A.label=D.text();D.attr("value","")}else{A.options.push({domNode:D[0],title:D.text(),value:D.val(),selected:D.is(":selected")})}});if(!A.selected){A.selected={index:0,title:A.$options.eq(0).text(),value:$option[0].value};A.focusIndex=0}A.render()}},render:function(){var D=this,B=D.isTouch&&D.nativeTouch?" touch":"",A=D.disabled?" disabled":"";D.$container=D.$select.wrap('<div class="'+D.wrapperClass+B+A+'"><span class="old"/></div>').parent().parent();D.$active=E('<span class="selected">'+D.selected.title+"</span>").appendTo(D.$container);D.onChange(D.selected);D.$carat=E('<span class="carat"/>').appendTo(D.$container);D.$container.css("width",(D.$container.width()+20)+"px");D.$scrollWrapper=E('<div style="min-width:180px;"><ul/></div>').appendTo(D.$container);D.$dropDown=D.$scrollWrapper.find("ul");D.$form=D.$container.closest("form");E.each(D.options,function(){var K=this,L=K.selected?' class="active"':"";D.$dropDown.append("<li"+L+">"+K.title+"</li>")});D.$items=D.$dropDown.find("li");D.maxHeight=0;if(D.cutOff&&D.$items.length>D.cutOff){D.$container.addClass("scrollable")}for(i=0;i<D.$items.length;i++){var C=D.$items.eq(i);D.maxHeight+=C.outerHeight();if(D.cutOff==i+1){break}}if(D.isTouch&&D.nativeTouch){D.bindTouchHandlers()}else{D.bindHandlers()}},bindTouchHandlers:function(){var A=this;A.$container.on("click.easyDropDown",function(){A.$select.focus()});A.$select.on({change:function(){var C=E(this).find("option:selected"),B=C.text(),D=C.val();A.$active.text(B);if(typeof A.onChange==="function"){A.onChange.call(A.$select[0],{title:B,value:D})}},focus:function(){A.$container.addClass("focus")},blur:function(){A.$container.removeClass("focus")}})},bindHandlers:function(){var A=this;A.query="";A.$container.bind({"click.easyDropDown":function(){if(!A.down&&!A.disabled){A.open()}else{A.close()}},"mousemove.easyDropDown":function(){if(A.keyboardMode){A.keyboardMode=false}}});E("body").bind("click.easyDropDown."+A.id,function(B){var C=E(B.target),D=A.wrapperClass.split(" ").join(".");if(!C.closest("."+D).length&&A.down){A.close()}});A.$items.bind({"click.easyDropDown":function(){var B=E(this).index();A.select(B);A.$select.focus()},"mouseover.easyDropDown":function(){if(!A.keyboardMode){var B=E(this);B.addClass("focus").siblings().removeClass("focus");A.focusIndex=B.index()}},"mouseout.easyDropDown":function(){if(!A.keyboardMode){E(this).removeClass("focus")}}});A.$select.bind({"focus.easyDropDown":function(){A.$container.addClass("focus");A.inFocus=true},"blur.easyDropDown":function(){A.$container.removeClass("focus");A.inFocus=false},"keydown.easyDropDown":function(C){if(A.inFocus){A.keyboardMode=true;var B=C.keyCode;if(B==38||B==40||B==32){C.preventDefault();if(B==38){A.focusIndex--;A.focusIndex=A.focusIndex<0?A.$items.length-1:A.focusIndex}else{if(B==40){A.focusIndex++;A.focusIndex=A.focusIndex>A.$items.length-1?0:A.focusIndex}}if(!A.down){A.open()}A.$items.removeClass("focus").eq(A.focusIndex).addClass("focus");if(A.cutOff){A.scrollToView()}A.query=""}if(A.down){if(B==9||B==27){A.close()}else{if(B==13){C.preventDefault();A.select(A.focusIndex);A.close();return false}else{if(B==8){C.preventDefault();A.query=A.query.slice(0,-1);A.search();clearTimeout(A.resetQuery);return false}else{if(B!=38&&B!=40){var D=String.fromCharCode(B);A.query+=D;A.search();clearTimeout(A.resetQuery)}}}}}}},"keyup.easyDropDown":function(){A.resetQuery=setTimeout(function(){A.query=""},1200)}});A.$dropDown.bind("scroll.easyDropDown",function(B){if(A.$dropDown[0].scrollTop>=A.$dropDown[0].scrollHeight-A.maxHeight){A.$container.addClass("bottom")}else{A.$container.removeClass("bottom")}});if(A.$form.length){A.$form.bind("reset.easyDropDown",function(){var B=A.hasLabel?A.label:A.options[0].title;A.$active.text(B)})}},unbindHandlers:function(){var A=this;A.$container.add(A.$select).add(A.$items).add(A.$form).add(A.$dropDown).remove(".easyDropDown");E("body").remove("."+A.id)},open:function(){var A=this,B=window.scrollY||document.documentElement.scrollTop,D=window.scrollX||document.documentElement.scrollLeft,C=A.notInViewport(B);A.closeAll();A.$select.focus();window.scrollTo(D,B+C);A.$container.addClass("open");A.$scrollWrapper.css("height",A.maxHeight+"px");A.down=true},close:function(){var A=this;A.$container.removeClass("open");A.$scrollWrapper.css("height","0px");A.focusIndex=A.selected.index;A.query="";A.down=false},closeAll:function(){var A=this,B=Object.getPrototypeOf(A).instances;for(var D in B){var C=B[D];C.close()}},select:function(B){var A=this;if(typeof B==="string"){B=A.$select.find("option[value="+B+"]").index()-1}var D=A.options[B],C=A.hasLabel?B+1:B;A.$items.removeClass("active").eq(B).addClass("active");A.$active.text(D.title);A.$select.find("option").removeAttr("selected").eq(C).prop("selected",true).parent().trigger("change");A.selected={index:B,title:D.title,value:D.value};A.focusIndex=i;if(typeof A.onChange==="function"){A.onChange.call(A.$select[0],{title:D.title,value:D.value})}},search:function(){var C=this,A=function(J){C.focusIndex=J;C.$items.removeClass("focus").eq(C.focusIndex).addClass("focus");C.scrollToView()},B=function(J){return C.options[J].title.toUpperCase()};for(i=0;i<C.options.length;i++){var D=B(i);if(D.indexOf(C.query)==0){A(i);return}}for(i=0;i<C.options.length;i++){var D=B(i);if(D.indexOf(C.query)>-1){A(i);break}}},scrollToView:function(){var C=this;if(C.focusIndex>=C.cutOff){var B=C.$items.eq(C.focusIndex),A=(B.outerHeight()*(C.focusIndex+1))-C.maxHeight;C.$dropDown.scrollTop(A)}},notInViewport:function(A){var D=this,B={min:A,max:A+(window.innerHeight||document.documentElement.clientHeight)},C=D.$dropDown.offset().top+D.maxHeight;if(C>=B.min&&C<=B.max){return 0}else{return(C-B.max)+5}},destroy:function(){var A=this;A.unbindHandlers();A.$select.unwrap().siblings().remove();A.$select.unwrap();delete Object.getPrototypeOf(A).instances[A.$select[0].id]},disable:function(){var A=this;A.disabled=true;A.$container.addClass("disabled");A.$select.attr("disabled",true);if(!A.down){A.close()}},enable:function(){var A=this;A.disabled=false;A.$container.removeClass("disabled");A.$select.attr("disabled",false)}};var F=function(C,B){C.id=!C.id?"EasyDropDown"+H():C.id;var A=new G();if(!A.instances[C.id]){A.instances[C.id]=A;A.init(C,B)}},H=function(){return("00000"+(Math.random()*16777216<<0).toString(16)).substr(-6).toUpperCase()};E.fn.easyDropDown=function(){var B=arguments,A=[],C;C=this.each(function(){if(B&&typeof B[0]==="string"){var D=G.prototype.instances[this.id][B[0]](B[1],B[2]);if(D){A.push(D)}}else{F(this,B[0])}});if(A.length){return A.length>1?A:A[0]}else{return C}};E(function(){if(typeof Object.getPrototypeOf!=="function"){if(typeof"test".__proto__==="object"){Object.getPrototypeOf=function(A){return A.__proto__}}else{Object.getPrototypeOf=function(A){return A.constructor.prototype}}}E("select.dropdown").each(function(){var A=E(this).attr("data-settings");settings=A?E.parseJSON(A):{};F(this,settings)})})})(jQuery);(function(m){function G(B,L,N){var H=B[0],M=/er/.test(N)?h:/bl/.test(N)?q:f;active=N==D?{checked:H[f],disabled:H[q],indeterminate:"true"==B.attr(h)||"false"==B.attr(r)}:H[M];if(/^(ch|di|in)/.test(N)&&!active){o(B,M)}else{if(/^(un|en|de)/.test(N)&&active){s(B,M)}else{if(N==D){for(var M in active){active[M]?o(B,M,!0):s(B,M,!0)}}else{if(!L||"toggle"==N){if(!L){B[t]("ifClicked")}active?H[u]!==l&&s(B,M):o(B,M)}}}}}function o(T,B,L){var U=T[0],P=T.parent(),M=B==f,N=B==h,H=N?r:M?F:"enabled",Q=J(U,H+I(U[u])),O=J(U,B+I(U[u]));if(!0!==U[B]){if(!L&&B==f&&U[u]==l&&U.name){var R=T.closest("form"),S='input[name="'+U.name+'"]',S=R.length?R.find(S):m(S);S.each(function(){this!==U&&m.data(this,K)&&s(m(this),B)})}N?(U[B]=!0,U[f]&&s(T,f,"force")):(L||(U[B]=!0),M&&U[h]&&s(T,h,!1));j(T,M,B,L)}U[q]&&J(U,n,!0)&&P.find("."+C).css(n,"default");P[p](O||J(U,B));P[E](Q||J(U,H)||"")}function s(H,O,P){var N=H[0],M=H.parent(),B=O==f,S=O==h,Q=S?r:B?F:"enabled",R=J(N,Q+I(N[u])),L=J(N,O+I(N[u]));if(!1!==N[O]){if(S||!P||"force"==P){N[O]=!1}j(H,B,Q,P)}!N[q]&&J(N,n,!0)&&M.find("."+C).css(n,"pointer");M[E](L||J(N,O)||"");M[p](R||J(N,Q))}function k(B,H){if(m.data(B,K)){var L=m(B);L.parent().html(L.attr("style",m.data(B,K).s||"")[t](H||""));L.unbind(".i").unwrap();m(A+'[for="'+B.id+'"]').add(L.closest(A)).unbind(".i")}}function J(B,H,L){if(m.data(B,K)){return m.data(B,K).o[H+(L?"":"Class")]}}function I(B){return B.charAt(0).toUpperCase()+B.slice(1)}function j(H,B,M,L){if(!L){if(B){H[t]("ifToggled")}H[t]("ifChanged")[t]("if"+I(M))}}var K="iCheck",C=K+"-helper",l="radio",f="checked",F="un"+f,q="disabled",r="determinate",h="in"+r,D="update",u="type",p="addClass",E="removeClass",t="trigger",A="label",n="cursor",v=/ipad|iphone|ipod|android|blackberry|windows phone|opera mini/i.test(navigator.userAgent);m.fn[K]=function(M,B){var S=":checkbox, :"+l,V=m(),O=function(W){W.each(function(){var X=m(this);V=X.is(S)?V.add(X):V.add(X.find(S))})};if(/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(M)){return M=M.toLowerCase(),O(this),V.each(function(){"destroy"==M?k(this,"ifDestroyed"):G(m(this),!0,M);m.isFunction(B)&&B()})}if("object"==typeof M||!M){var N=m.extend({checkedClass:f,disabledClass:q,indeterminateClass:h,labelHover:!0},M),Q=N.handle,H=N.hoverClass||"hover",U=N.focusClass||"focus",R=N.activeClass||"active",P=!!N.labelHover,T=N.labelHoverClass||"hover",L=(""+N.increaseArea).replace("%","")|0;if("checkbox"==Q||Q==l){S=":"+Q}-50>L&&(L=-50);O(this);return V.each(function(){k(this);var Z=m(this),W=this,X=W.id,a=-L+"%",d=100+2*L+"%",d={position:"absolute",top:a,left:a,display:"block",width:d,height:d,margin:0,padding:0,background:"#fff",border:0,opacity:0},a=v?{position:"absolute",visibility:"hidden"}:L?d:{position:"absolute",opacity:0},Y="checkbox"==W[u]?N.checkboxClass||"icheckbox":N.radioClass||"i"+l,c=m(A+'[for="'+X+'"]').add(Z.closest(A)),b=Z.wrap('<div class="'+Y+'"/>')[t]("ifCreated").parent().append(N.insert),d=m('<ins class="'+C+'"/>').css(d).appendTo(b);Z.data(K,{o:N,s:Z.attr("style")}).css(a);N.inheritClass&&b[p](W.className);N.inheritID&&X&&b.attr("id",K+"-"+X);"static"==b.css("position")&&b.css("position","relative");G(Z,!0,D);if(c.length){c.bind("click.i mouseenter.i mouseleave.i touchbegin.i touchend.i",function(w){var e=w[u],g=m(this);if(!W[q]){if("click"==e?G(Z,!1,!0):P&&(/ve|nd/.test(e)?(b[E](H),g[E](T)):(b[p](H),g[p](T))),v){w.stopPropagation()}else{return !1}}})}Z.bind("click.i focus.i blur.i keyup.i keydown.i keypress.i",function(g){var e=g[u];g=g.keyCode;if("click"==e){return !1}if("keydown"==e&&32==g){return W[u]==l&&W[f]||(W[f]?s(Z,f):o(Z,f)),!1}if("keyup"==e&&W[u]==l){!W[f]&&o(Z,f)}else{if(/us|ur/.test(e)){b["blur"==e?E:p](U)}}});d.bind("click mousedown mouseup mouseover mouseout touchbegin.i touchend.i",function(e){var w=e[u],g=/wn|up/.test(w)?R:H;if(!W[q]){if("click"==w){G(Z,!1,!0)}else{if(/wn|er|in/.test(w)){b[p](g)}else{b[E](g+" "+R)}if(c.length&&P&&g==H){c[/ut|nd/.test(w)?E:p](T)}}if(v){e.stopPropagation()}else{return !1}}})})}return this}})(jQuery);(function(C){var D=function(B,A){this.grid=C(B);this.rows=[];this.url=A.url;var F=C.extend({},C.fn.grid.defaults.params,A.params);this.options=C.extend({},C.fn.grid.defaults,A);C.extend(this,this.options);this.params=F;this.initContainer()};D.prototype={constructor:D,initContainer:function(){var A=this.options;this.rowTemplate=this.grid.html();this.grid.data("events",{});this.clean();if(this.autoload){this.load()}},createRows:function(A){for(var F=0,B=A.length;F<B;F++){A[F].rowIndex=F+1;this.rows.push(this.createRow(A[F]))}return this.rows},createRow:function(A){this.setData(A);if(this.beforeInsert){this.beforeInsert(A)}var B=this.createRowTemplate?this.createRowTemplate(A):this.rowTemplate;var F=C(HG.fullProperty(B,A));F.css("cursor","pointer");if(this.clickable){F.bind("click",{record:A,grid:this},this._onRowClick)}F.bind("mouseover",{record:A,grid:this},this._onMouseOver);F.bind("mouseout",{record:A,grid:this},this._onMouseOut);if(this.clickable){F.bind("dblclick",{record:A,grid:this},this._onRowDoubleClick)}return F},createPagination:function(X){var b=X.pageNo,Z=X.totalCount,g=X.pageSize;var a=X.totalPage||(Z+g-1)/g;if(Z===0){return}var B=this;B.params.pageNo=B.params.pageNo||1;this.pagination=C('<div class="page"></div>');var W=C("<ul></ul>");if(b>1){var V=C('<li><a href="javascript:;">首页</a></li>');V.bind("click",function(){B.params.pageNo=1;B.load()});W.append(V);var U=C('<li><a href="javascript:;">上一页</a></li>');U.bind("click",function(){B.params.pageNo=b-1;B.load()});W.append(U)}var h=b-4;var e=b+5;if(h<0){e-=(h-1);h=1}if(e>a){h-=e-a;e=a;h=h<1?1:h}for(var f=h;f<=e;f++){var A;if(f==b){A=C('<li><a href="javascript:;" style="color:red;font-weight: bold;">'+f+"</a></li>")}else{A=C('<li><a href="javascript:;">'+f+"</a></li>")}A.data("pn",f);A.bind("click",function(){B.params.pageNo=C(this).data("pn");B.load()});W.append(A)}if(b<a){var d=C('<li><a href="javascript:;">下一页</a></li>');d.bind("click",function(){B.params.pageNo=b+1;B.load()});W.append(d);var c=C('<li><a href="javascript:;">尾页</a></li>');c.bind("click",function(){B.params.pageNo=a;B.load()});W.append(c)}W.append('<li class="yeshu">共 '+a+"页  </li>");var Y=C('<input type="submit" class="yetijiao" value="确定" />');Y.bind("click",function(){var F=C(this).prev();var E=F.val();E=isNaN(E)?b:E;E=E<1?1:E;E=E>a?a:E;F.val(E);B.params.pageNo=E;B.load()});var T=C('<li class="daod" style="margin-left: 15px;margin-top:3px;">到第<input type="text" class="yetxt" style="height: 17px;line-height: 17px;vertical-align: top;" value="'+b+'"> 页</li>');T.append(Y);W.append(T);this.pagination.append(W);return this.pagination},clean:function(){this.grid.children().remove();if(this.pagination){this.pagination.remove()}this.rows=[]},render:function(A){var G=this.createRows(A.list);for(var B in G){C(this.grid).append(G[B])}if(G.length>0){var H=this.createPagination(A);this.grid.parent().parent().append(H)}},load:function(B,J){var A=this;var H=A.options;var I=H.method;this.url=J||this.url;C.extend(this.params,B);if(A.beforeLoad){A.beforeLoad()}C.ajax({type:I,url:this.url,dataType:"json",timeout:this.options.timeout,data:this.params,success:function(E){A.result=E;A.clean();A.render(E);initUI(A.grid);if(A.afterLoad){A.afterLoad()}},error:function(E){if(A.loadFailure){A.loadFailure()}}})},getSelected:function(){return this.selected},setData:function(A){return A},_onRowClick:function(A){var B=A.data.grid;B.selected=A.data.record;if(C(A.target).hasClass("disable-selected")){return}if(B.isBind("selection")){B.grid.trigger("selection",[A.data.record,B,this])}if(B.selectRow){B.selectRow.removeClass("row-selection")}var F=C(this);F.addClass("row-selection");B.selectRow=F;if(B.onRowClick){B.onRowClick(A.data.record,A.data.row,B)}},_onRowDoubleClick:function(A){var F=C(this),B=A.data.grid;if(B.isBind("doubleclick")){B.grid.trigger("doubleclick",[A.data.record,B,this])}},_onMouseOver:function(A){var F=C(this),B=A.data.grid;F.toggleClass("row-hover");if(B.isBind("mouseover")){B.grid.trigger("mouseover",[B,this])}},_onMouseOut:function(A){var F=C(this),B=A.data.grid;F.toggleClass("row-hover");if(B.isBind("mouseout")){B.grid.trigger("mouseout",[B,this])}},on:function(A,B){this.grid.bind(A,B);this.grid.data("events")[A]=true},isBind:function(A){return this.grid.data("events")[A]}};C.fn.grid=function(F){var A;var B=this.each(function(){var E=C(this);var I=E.data("grid");var J=typeof F==="object"&&F;J.params=J.params||{};if(!I){E.data("grid",(I=new D(this,J)))}if(typeof F==="string"){A=I[F]()}});return(A===undefined)?B:A};C.fn.grid.defaults={autoload:true,params:{pageNo:1,pageSize:10},clickable:true};C.fn.grid.Constructor=D})(jQuery);