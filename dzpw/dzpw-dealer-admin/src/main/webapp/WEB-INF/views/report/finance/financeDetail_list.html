<#assign contextPath=springMacroRequestContext.getContextPath() />

<script type="text/javascript">

	function checkTimeStr(){
		
		if($("#BeginTimeStr", navTab.getCurrentPanel()).val()=="" && $("#EndTimeStr", navTab.getCurrentPanel()).val()!=""){
		
			alert("不能只有出票开始日期或结束日期!");
			return false
		}else if($("#BeginTimeStr", navTab.getCurrentPanel()).val()!="" && $("#EndTimeStr", navTab.getCurrentPanel()).val()==""){
			
			alert("不能只有出票开始日期或结束日期!");
			return false
		}if($("#BeginTimeStr", navTab.getCurrentPanel()).val()>$("#EndTimeStr", navTab.getCurrentPanel()).val()){
			
			alert("出票开始时间不能大于出票结束时间!");
			return false
		}else{
			return true;
		}
	}

</script>

<div class="pageHeader">
	<form id="pagerForm" rel="pagerForm" onsubmit="return navTabSearch(this);" action="${contextPath}/finance/detail" method="post">
		<input type="hidden" name="pageNum" value="${pagination.pageNo}" />
		<input type="hidden" name="numPerPage" value="${pagination.pageSize}" />
		<div class="searchBar">
			<table class="searchContent">
				<tr>
 					<td> 
 						结算流水号：<input type="text" id="settleNo" name="name" value="${pagination.condition.settleNo}" size="25"/>
 					</td> 
 					<td>
 						产品编号：<input type="text" name="policyNo" value="${pagination.condition.policyNo}" size="25" />
 					</td>
 					<td>
 						 &nbsp;票&nbsp;务&nbsp;名&nbsp;称：<input type="text" name="policyName" value="${pagination.condition.policyName}" size="25"/>
 					</td>
					<td>
					订&nbsp;单&nbsp;状&nbsp;态&nbsp;：
					<select name="status">
						<option value="">全部</option>
						<option value="0"  <#if pagination.condition.status==0>selected="selected"</#if>>等待支付</option>
						<option value="1"  <#if pagination.condition.status==1>selected="selected"</#if>>支付成功</option>
						<option value="2"  <#if pagination.condition.status==2>selected="selected"</#if>>出票成功</option>
						<option value="3"  <#if pagination.condition.status==3>selected="selected"</#if>>交易成功</option>
						<option value="4"  <#if pagination.condition.status==4>selected="selected"</#if>>交易关闭</option>
					</select>
					</td>
 				</tr>
 				<tr>
					<td>
 						 订 单 编 号 ：<input type="text" name="orderId" value="${pagination.condition.orderId}" size="25" />
 					</td>
 					<td>
						出票时间：
						<input type="text" id="BeginTimeStr" name="BeginTimeStr" value="${BeginTimeStr}" class="date" readonly="true"/>-
						<input type="text" id="EndTimeStr" name="EndTimeStr" value="${EndTimeStr}" class="date" readonly="true" />
					</td>
 					<td></td><td></td>
					<td >
					<ul>
						<li style="display:inline-block;">
							<div class="buttonActive"><div class="buttonContent"> <button type="submit" onclick="return checkTimeStr()">查询</button></div></div>
						</li>
						<li style="display:inline-block;">
							<div class="button"><div class="buttonContent"> <button type="button" onclick="formReSet(this)">重置</button></div></div>
						</li>
					</ul>
					</td>
 				</tr>
			</table>
		</div>
	</form>
</div>

<div class="pageContent">
	<div class="panelBar">
		<ul class="toolBar">
			<li>
				<a class="icon" href="${contextPath}/finance/export" target="dwzExport"><span>导出报表</span></a>
			</li>
		</ul>
	</div>
	<div class="panelBar">
		<ul>
            <li style="line-height:25px;margin: 0px 15px;">出票时间：${(pagination.condition.dateBegin?string("yyyy-MM-dd"))!""} 至${(pagination.condition.dateEnd?string("yyyy-MM-dd"))!""}</li>
 			<li style="line-height:25px;margin: 0px 15px;">经销商结算：¥${(pagination.list[0].totalPrice)!0} </li>
			<li style="line-height:25px;margin: 0px 15px;">手续费：¥${(pagination.list[0].totalDealerFee)!0}</li>
			<li style="line-height:25px;margin: 0px 15px;">退款金额：¥${(pagination.list[0].totalAmount)!0}</li>
		</ul>
		
	</div>
	
	<table class="table" width="180%" layoutH="190" id="table_caiwu" style="overflow:auto;">
		<thead>
			<tr>
				<th width="130px;">订单编号</th>
				<th width="120px;">票务编号</th>
				<th width="120px;">产品编码</th>
				<th width="200px;">产品名称</th>
				<th width="150px;">所属单位</th>
				<th width="100px;">订票人</th>
				<th width=120px;>下单时间</th>
				<th width="120px;">出票时间</th>
				<th width="80px;">结算价(元)</th>
				<th width="80px;">手续费(元)</th>
				<th width="200px;">支付流水号</th>
				<th width="190px;">退款账号</th>
				<th width="220px;">退款批次号</th>
				<th width="100px;">退款金额(元)</th>
				<th width=150px;>退款时间</th>
				<th width="80px;">订单状态</th>
			</tr>
		</thead>
		<#list pagination.list as t>
			<tr>
				<td>${t.orderId}</td>
				<td>${t.ticketNo}</td>
				<td>${t.policyNo}</td>
				<td>${t.policyName}</td>
				<td>${t.scenicSpotNameStr}</td>
				<td>${t.linkMan}</td>
				<td>${t.createDate?string("yyyy-MM-dd HH:mm:ss")}</td>
				<td>${(t.ticketDate?string("yyyy-MM-dd HH:mm:ss"))!''}</td>
				<td>${t.dealerAmount}</td>
				<td>${t.dealerSettlementFee}</td>
				<td>${t.payTradeNo}</td>
				<td>${t.dealerAccountNumber}</td>
				<td>${t.refundBatchNo}</td>
				<td>${t.refundAmmount}</td>
				<td>${(t.refundTime?string("yyyy-MM-dd HH:mm:ss"))!""}</td>
				<td>
					<#if t.status==0>
						等待支付
					</#if>
					<#if t.status==1>
						支付成功
					</#if>
					<#if t.status==2>
						出票成功
					</#if>
					<#if t.status==3>
						交易成功
					</#if>
					<#if t.status==4>
						交易关闭
					</#if>
				</td>
			</tr>
		</#list>
	</table>
	<#include "/public/pagination/pagination.html">

</div>
