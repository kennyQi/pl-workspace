<#assign contextPath=springMacroRequestContext.getContextPath() />


<div class="pageHeader" id="header_spor">
	
	<form id="pagerForm" rel="pagerForm" onsubmit="return navTabSearch(this);"
		action="${contextPath}/viewspot/spots/list" method="post">
		<input type="hidden" name="pageNum" value="${pagination.pageNo?c}" />
		<input type="hidden" name="numPerPage" value="${pagination.pageSize?c}" />
		<div class="searchBar">
			<table class="searchContent">
				<tr>
					<td style="text-align: left">
						供应商：
					</td>
					<td style="text-align: left">
						<select>
							<option value="">全部</option>
							<option value="1">同城</option>
						</select>					
					</td>
					<td style="text-align: left">
						景点名称：
					</td>
					<td id="spot"><input type="text" name="name" value="${platformSpotsQO.name}" id="spotsname">					
					<table id="searchresult" style="display: none;">  
        			</table> </td>

				</tr>
			</table>
			<div class="subBar">
				<ul>
					<li><div class="buttonActive">
							<div class="buttonContent">
								<button type="submit">查询</button>
							</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</form>
</div>
<div class="pageContent">
	<div class="panelBar">
		<ul class="toolBar">
		</ul>
	</div>
	<table class="table" width="100%" layoutH="137" >
		<thead>
			<tr>
				<th width="22"><input type="checkbox" group="ids"
					class="checkboxCtrl">
				</th>
 				<th width="50">供应商平台</th>
				<th width = "50">门票名称</th>
				<th width = "50">价格日历</th>
				<th width = "50">省</th>
				<th width = "50">市</th>
				<th width="40">操作</th>
			</tr>
		</thead>
		<tbody>
			<#if (policyDTOList?size>0)>
			<#list policyDTOList as policyDTO>
			<tr>

				<td><input name="ids" value="${policyDTO.id}" type="checkbox">
				</td>
				<td>同城</td>
				<td>${policyDTO.name}</td>
				<td><a href="${contextPath}/viewspot/spots/calendar?policyId=${policyDTO.policyId}" target="_blank" style="color: blue">查看价格日历</a></td>
				<td>${policyDTO.scenicSpotSnapshot.provinceName}</td>
				<td>${policyDTO.scenicSpotSnapshot.cityName}</td>
				<td><a  target="dialog"
					href="${contextPath}/viewspot/spots/detail?id=${policyDTO.scenicSpotSnapshot.scenicSpotsId}&policyId=${policyDTO.policyId}" width="900" height="900" style="color: blue">查看详情</a></td>

			</tr>
			</#list>
			</#if>			
		</tbody>
	</table>
	<#include "/public/pagination/pagination.html">
</div>
<script type="text/javascript">
$(function(){
	$("#spotsname").keyup(function(evt){
        var k = window.event ? evt.keyCode : evt.which;  
        //输入框的id为txt_search，这里监听输入框的keyup事件  
        //不为空 && 不为上箭头或下箭头或回车  
        if($("#spotsname").val()!="" && k != 38 && k != 40 && k != 13){
        	$.post("${contextPath}/viewspot/spots/match",{'spotname':$("#spotsname").val()},function(data){

                if (data.length > 0) {  
                    var layer = "";  
                    $.each(data, function (idx, item) {  
                        layer += "<tr><td>" + item.name + "</td></tr>";  
                    });  
					
                    //将结果添加到div中      
                    $("#searchresult").empty();  
                    $("#searchresult").append(layer);  
                    $("#searchresult").show(); 


                    	$("#searchresult tbody tr td").click(function(){                		
                		$("#spotsname").val($(this).text());
                	    $("#searchresult").hide();
                    });  

                } else {  
                    $("#searchresult").empty();  
                    $("#searchresult").hide();
                }  
        	},"json"); 

        }                

	
});
	
    $("#searchresult").bind("mouseleave", function () {  
        $("#searchresult").empty();  
        $("#searchresult").css("display", "none");  
    });  
	
});




 
</script>
