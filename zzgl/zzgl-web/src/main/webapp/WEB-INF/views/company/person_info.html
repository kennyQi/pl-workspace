<#assign contextPath=springMacroRequestContext.getContextPath() />
<#import "/public/frame/default.html" as frame />
<@frame.head "中智票量-会员中心">

<link href="${(contextPath)!}/resources/css/personal/personal_accountInf.css" rel="stylesheet" />
<script src="${(contextPath)!}/resources/js/company/company_accountInf.js" language="javascript"></script>
<script src="${(contextPath)!}/resources/js/company/laydate/laydate.js" language="javascript"></script>
<script>
	(function(){

		//调用日期插件
		;!function(){
			laydate.skin('dahong');
			laydate({
				elem: '#birthday'
			});
		}();
	})();
</script>
</@frame.head>

<@frame.main "default" 1>
<div class="g_bd disb yahei">

	<!-- 更换手机号  原手机验证码弹出框 -->
	<div class="checkMobileBox">
		<div class="boxMessage">
			<div class="boxTitle floating_p">更换手机号码<a href="javascript:;"></a></div>
			<div class="checkBox color3 h3 yahei fl">

			</div>
		</div>
	</div>

	<!-- 更换手机号 确认弹出框 -->
	<div class="successBox">
		<div class="boxMessage">
			<div class="boxTitle floating_p">更换手机号码<a href="javascript:;"></a></div>
			<div class="checkBox color3 h3 yahei fl">

			</div>
		</div>
	</div>
	<!-- 个人中心顶部 -->
	<@frame.top ></@frame.top>

<div class="g_cont disb ov">
	<@frame.nav "账户资料" 4></@frame.nav>
<div class="m_cont ov fl">
	<!--右侧呈现页-->
	<div class="ri">
		<h1 class="rih1 yahei normal">账户资料</h1>
		<div class="navsbox"></div>

		<form id="form1" action="${contextPath}/company/infoManage/update" method="post" >
			<input type="hidden" id="suc" value="${succ!}"/>
			<input type="hidden" name="userId" value="${(user.authInfo.loginName)!}"/>
			<input type="hidden" id="mobile" name="mobile" value="${(user.contactInfo.mobile)!}"/>
			<input type="hidden" id="send" value="0"/>
			<input type="hidden" id="cityId" value="${(user.contactInfo.cityId)!}"/>

			<input type="hidden" id="province" name="province" value="${(user.contactInfo.provinceId)!}"/>
			<input type="hidden" id="city" name="city" value="${(user.contactInfo.cityId)!}"/>
			<input type="hidden" id="saveBirthday" name="birthday"/>

			<ul class="infBox color3 yahei h3 bold">
				<li><span class="infTitle">用户名:</span><span style="padding:0 11px;">${(user.authInfo.loginName)!}</span></li>
				<li><span class="infTitle">邮箱：</span><input class="textBox inp input_p" type="text" id="email" name="email" value="${(user.contactInfo.email)!}">
					<#if (user.status.isEmailChecked)==false>
						<span class="yanz" id="send_email" onclick="sendMail()">验证邮箱</span>
					</#if>
					</p></li>
				<li>
					<span class="infTitle">性别：</span>
		      <span class="L">
		      	<input type="radio" name="gender" value="1" class="typeradio" <#if (user.baseInfo.gender)==1> checked="checked"</#if>/> 男
		      </span>
					<span class="L"><input type="radio" name="gender" value="2" class="typeradio" <#if (user.baseInfo.gender)==2> checked="checked"</#if>/> 女</span>
					<span class="L"><input type="radio" name="gender" class="typeradio"  value="3"<#if (user.baseInfo.gender)==null||(user.baseInfo.gender)==3> checked="checked"</#if>/> 保密</span>
				</li>

				<li><span class="infTitle">昵称：</span><input class="textBox inp input_p" type="text" id="nickName" name="nickName" value="${(user.baseInfo.nickName)!}"/></li>
				<li>
					<span class="infTitle">所在区域:</span>
					<span class="select fl normal companySelect" id="optionValue">请选择</span>
					<ul id="province_id" class="selectNav normal province" for="optionValue" forName="province">
						<li class="l">请选择</li>
						<#list provinces as province>
							<li class="l" value="${(province.code)!}" id="province_${(province.code)!}" >
								<#if user.contactInfo.provinceId=="${(province.code)!}"></#if>
								${(province.name)!}
							</li>
						</#list>
						<script>
							$(function(){
								$("#province_${(user.contactInfo.provinceId)!}").trigger("click");
							});
						</script>
					</ul>
					<span style="margin-left:10px;" class="select fl normal citys companySelect" id="optionValue1">请选择</span>
					<ul id="city_id" class="selectNav normal city" style="margin-left:215px;" for="optionValue1" forName="city">
						<li class="l">请选择</li>
					</ul>
				</li>
				<li><span class="infTitle">真实姓名：</span><input type="text" id="name" name="name" class="textBox inp input_p" value="${(user.baseInfo.name)!}"/></li>
				<li><span class="infTitle">生日：</span><input class="textBox inp input_p" type="text" id="birthday"
															value="<#if user.baseInfo.birthday??>${(user.baseInfo.birthday?substring(0,10))!}</#if>"
															onclick="laydate({});"/></li>
				<li>
					<span class="infTitle">绑定手机:</span>
					<!--不直接显示手机号 从value值里面取-->
					<span class="fl" style="margin:0 10px;" id="per_mobile" value="${(user.contactInfo.mobile)!}">${(user.contactInfo.mobile?substring(0,4))!}****${(user.contactInfo.mobile?substring(8))!}</span>
					<span class="countdown"><a href="javascript:;" class="checkMobi checkMobis hover tc yahei h3 color3 normal fl" >更换手机号码</a></span>
					<input id="token" type="hidden" name="token"/>
				</li>

			</ul>
			<a class="preservation fl yahei" href="#" onclick="reg();">保 存</a>
		</form>
	</div>
</div>
</div>
</div>
</div>

</@frame.main>
<@frame.end "default"> </@frame.end>
<script type="text/javascript">
	$(function () {
		var uId=$.trim($("#suc").val());
		if(uId.length>0){
			alert("修改资料成功");
		}
	});
	function  trim(str) {
		return str.replace(/^\s+|\s+$/g,'');
	}
	function reg(){
		var mail =$("#email").val();
		var regmail=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
		var companyReg=/^[\u4E00-\u9FA5]{1,10}$/;
		var nickReg=/^[\w\u4e00-\u9fa5]+$/gi;//匹配中文 数字 字母 下划线
		var nickName =$("#nickName").val();
		var name=$("#name").val();
		var birthday=trim($("#birthday").val());
		$("#saveBirthday").val(birthday);
		if(nickName.length>6){
			alert("昵称的名称不能超过6位！");
			return false;
		}

		if(!nickReg.test(nickName)){
			alert("请正确输入用户昵称");
			return false;
		}
		if(!companyReg.test(name)){
			alert("请正确输入用户真实姓名");
			return false;
		}
		//邮箱认证	
		if(regmail.test(mail)){

		}else{
			alert("邮箱格式不正确");
			return false;
		}
		if(birthday==""){
			alert("生日不能为空");
			return false;
		}
		var pro=$("#province").val();
		var city=$("#city").val();

		$('#form1').submit();
	}

</script>